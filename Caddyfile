:8080 {
    # --- Data server (preserve full path) ---
    @bars path /api/bars*
    handle @bars {
        reverse_proxy http://127.0.0.1:8090
    }

    @trades path /api/trades*
    handle @trades {
        reverse_proxy http://127.0.0.1:8090
    }

    # --- Analytics server (preserve full path) ---
    @vwap path /api/vwap*
    handle @vwap {
        reverse_proxy http://127.0.0.1:8091
    }

    @indicators path /api/indicators*
    handle @indicators {
        reverse_proxy http://127.0.0.1:8091
    }

    @context path /api/context*
    handle @context {
        reverse_proxy http://127.0.0.1:8091
    }

    # --- Local health endpoint served by Caddy ---
    @health path /health*
    handle @health {
        header Content-Type application/json
        respond `{"ok":true,"via":"caddy"}` 200
    }
}
